<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Play</title>
    <link rel="stylesheet" href="css/playStyle.css">
    <style>
        body {
            font-family: Bahnschrift;
            font-size: 20px;
            background:linear-gradient(0deg, rgba(41,46,51,0.6), rgba(41,46,51,0.6)), url(images/playbg.jpg) repeat top left;
        }
    </style>
</head>
<body>
    <p id="timer" class="paragraph"></p>
    <img id = "question" style="height: 300px; width: 250px" class="center fade-in-image">
    <div class="row">
        <div class="column">
            <img id = "option1" style="height: 300px; width: 250px" class="center" onclick="selectOption(this.id)">
        </div>
        <div class="column">
            <img id = "option2" style="height: 300px; width: 250px" class="center" onclick="selectOption(this.id)">
        </div>
        <div class="column">
            <img id = "option3" style="height: 300px; width: 250px" class="center" onclick="selectOption(this.id)">
        </div>
    </div>
    <script>
        {
            var countDown = 10;
            var correctAns = 0;
            var wrongAns = 0;

            var timer = setInterval(function(){
                if(countDown <= 0){
                    alert("correct: " + correctAns+ "\n" + "wrong: " + wrongAns);
                    clearInterval(timer)
                }
                document.getElementById("timer").innerHTML =  countDown;
                countDown -= 1;
            }, 1000);

            


            function show() {
                var question = document.getElementById("question");
                var pictures = makeObjectOfPictures();
                var first = pictures[Math.floor(Math.random() * 9)];
                question.src = first.sourceImage;
                return first;
            }

            class Pictures {
                constructor(name, color, sourceImage) {
                    this.name = name;
                    this.color = color;
                    this.sourceImage = sourceImage;
                    this.correct = false;
                }
                setCorrectNess(correct){
                    this.correct = correct;
                }
                isCorrect(){
                    return this.correct;
                }

            }

            function makeObjectOfPictures(){
                var names = ["sunny", "cloudy", "rainy"];
                var colors = ["blue", "red", "gray"];
                var pictures = []
                for(var i = 0; i < names.length; ++i){
                    for (var j = 0; j < colors.length; ++j){
                        pictures[i * names.length + j] = new Pictures(names[i], colors[j], "images/card"+colors[j]+names[i]+".png");
                    }
                }
                return pictures;
            }

            var flag = 0;
            if(flag == 0){
                var question = show();
                flag ++;
            }
            var option = showOption();

            function showOption(){
                var pictures = makeObjectOfPictures();
                var option = [];
                for(var i=0; i<pictures.length; ++i){
                    if(pictures[i].name === "sunny" && pictures[i].color === "red") {
                        option[0] = pictures[i];
                        document.getElementById("option1").src = option[0].sourceImage;
                    }
                    else if(pictures[i].name === "cloudy" && pictures[i].color === "gray") {
                        option[1] = pictures[i]
                        document.getElementById("option2").src = option[1].sourceImage;
                    }
                    if(pictures[i].name === "rainy" && pictures[i].color === "blue") {
                        option[2] = pictures[i]
                        document.getElementById("option3").src = option[2].sourceImage;
                    }
                }
                return option;
            }

            function selectOption(clickedId){
                var correct = -1;
                for (var i=0; i<option.length; ++i) {
                    if (option[i].name === question.name && option[i].color === question.color) {
                        option[i].setCorrectNess(true);
                        correct = i;
                    }
                }
                if(correct == -1){
                    for (var i=0; i<option.length; ++i) {
                        if (option[i].name !== question.name && option[i].color !== question.color) {
                            option[i].setCorrectNess(true);
                            correct = i;
                        }
                    }
                }
                if("option" +(correct+1) == clickedId){
                    correctAns += 1;
                    console.log(true)
                    question = show()
                }else{
                    wrongAns += 1;
                    console.log(false)
                    question = show()
                }

            }
        }
    </script>
</body>
</html>